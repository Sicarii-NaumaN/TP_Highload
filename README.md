# Почта
## Целевая аудитория
- Россия, страны СНГ
- Каждый пользоветель в среднем проводит на сайте около 4ч 5м в месяц(8,1 минут в день). Источник: https://radar.yandex.ru/yandex?month=2021-08
## MVP
- Регистрация/авторизация
- Отправка/пересылка писем
- Чтение писем
- Прикрепление файлов(изображений, архивов)
- Удаление писем

## Нагрузка
Согласно оффициальной статистике на август 2021 (https://radar.yandex.ru/yandex?month=2021-08)
- Месячная аудитория - 19 390 981
- Дневная аудитория - 5 836 187
  
При этом доля мобильного приложения составляет 30%.

## Расчеты
Согласно опубликованной информации от Mail.ru, количество активных аккаунтов почты составляет ~100млн и ~46млн активных, 
средний размер хранилища пользователя составляет 20GB пользователей (https://corp.mail.ru/en/company/portal/)

Рассмотрим среднестатистического пользователя, пользующийся почтой 8,1 минут в день. 
Для дальнейших расчетов примем следущие допущения:
1) Пусть средний пользователь отправляет в день 3 письма(2 без вложения - ~5KB, 1 c вложением - 500KB)
2) Пусть средний пользователь получает 10 писем(33% из которых - с вложениями)  
3) Пользователь заходит в почту 8 раз в день (~ на 1 мин)   
4) Согласно https://habr.com/ru/post/321756/ письма с вложениями составляют 10%, учитывая современные реалии выберем цифру в 33%
5) Среднее количество запросов пользователя за время пребывание в сервисе ~500
6) Пиковая активность ~60% от общего количества посещений в день (5.8 * 10^6 * 0.6 = 3 480 000)

Расчитаем общее значение RPS:

      RPS = (5.8 * 10^6 * 500)/(24 * 60 * 60) ~ 33000

### Среднее количество действий пользователя по типам в день (RPS) (согласно MVP)

 - <b>Регистрация/авторизация</b>

Приняв во внимание пункт 3, расчитаем средний RPS для авторизации:

      RPS = (5.8 * 10^6 * 8)/(24 * 60 * 60) ~ 537

- <b>Отправка/пересылка писем</b>

Согласно пунту 1, объем данных 2 * 5 KB + 1 * 500KB = 510KB:

      RPS = (5.8 * 10^6 * 3)/(24 * 60 * 60) ~ 201

      Трафик: (5.8 * 10^6 * 510)/(24 * 60 * 60)  3423KB ~ 3,3MB

      Пиковое значение (пункт 6): 3.48 * 10^6 * 510KB ~ 13540 Gbit/sec

- <b>Чтение писем</b>

Согласно пунту 2, объем данных 7 * 5 KB + 3 * 500KB = 1535KB:

      RPS = (5.8 * 10^7)/(24 * 60 * 60) ~ 641

      Трафик: (5.8 * 10^6 * 1535)/(24 * 60 * 60)  ~ 100MB

      Пиковое значение (пункт 6): 3.48 * 10^6 * 1535 ~ 40 750 Gbit/sec

- <b>Прикрепление файлов(изображений, архивов)</b>

В среднем 1 отправленное письмо имеет вложение(пункт 1), объем данных 1 * 500KB = 500KB, тогда:

      RPS = (5.8 * 10^6)/(24 * 60 * 60) ~ 67

      Трафик: (5.8 * 10^6 * 500)/(24 * 60 * 60)  ~ 32MB

      Пиковое значение (пункт 6): 3.48 * 10^6 * 500 ~ 13 275 Gbit/sec

- <b>Удаление писем</b>

Согласно https://www.statista.com/statistics/420391/spam-email-traffic-share/ спам составляет порядка 45.1% от 
полученных писем(на март 2021г). Тогда из пункта 2: 10 * 45.1 / 100 = 4.5 (пусть 4 писем в среднем удаляет пользователь)

      RPS = (5.8 * 10^6 * 4)/(24 * 60 * 60) ~ 268
